# ============================================================
# AI Code Review Platform - Environment Configuration
# ============================================================
# Copy this file to .env and configure your values
# 
# IMPORTANT: For local development without AI providers:
#   1. Set MOCK_MODE=true
#   2. Leave API keys as placeholders
#   3. Run: docker compose up -d
#
# REQUIRED variables are marked with [REQUIRED]
# OPTIONAL variables have default values and can be left unchanged
# ============================================================

# ============================================================
# Mode Configuration [IMPORTANT]
# ============================================================
# Set to 'true' to run without real AI providers (uses mock responses)
MOCK_MODE=true

# Environment: development | staging | production
ENVIRONMENT=development

# ============================================================
# Port Configuration (Unified)
# ============================================================
# Frontend (Vite dev server)
FRONTEND_PORT=5173

# Backend API
API_PORT=8000

# ============================================================
# Database Configuration [REQUIRED for production]
# ============================================================
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=coderev
POSTGRES_PASSWORD=changeme_in_production
POSTGRES_DB=code_review_platform
DATABASE_URL=postgresql://coderev:changeme_in_production@localhost:5432/code_review_platform

# Neo4j Configuration
NEO4J_PASSWORD=changeme_in_production

# MinIO Configuration
MINIO_ROOT_USER=admin
MINIO_ROOT_PASSWORD=changeme_in_production

# ============================================================
# Redis Configuration
# ============================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=changeme
REDIS_URL=redis://:changeme@localhost:6379/0

# ============================================================
# AI Provider API Keys [OPTIONAL if MOCK_MODE=true]
# ============================================================
# When MOCK_MODE=true, these can be left as placeholders
# When MOCK_MODE=false, at least one provider is required

# OpenAI - Get key at: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-your-openai-key-here

# Anthropic - Get key at: https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-your-anthropic-key-here

# HuggingFace - Get token at: https://huggingface.co/settings/tokens
HUGGINGFACE_TOKEN=hf_your_token_here

# ============================================================
# Data Source API Keys [OPTIONAL - for network learning]
# ============================================================
# These keys enable the auto-network learning system to fetch
# data from external sources with higher rate limits.
# Without keys, public APIs will still work but with limitations.

# GitHub API Token - For trending repos, releases, code samples
# Get at: https://github.com/settings/tokens (select 'public_repo' scope)
GITHUB_TOKEN=

# StackOverflow API Key - For developer Q&A knowledge
# Get at: https://stackapps.com/apps/oauth/register
STACKOVERFLOW_KEY=

# Dev.to API Key - For technical articles
# Get at: https://dev.to/settings/extensions (generate API key)
DEVTO_API_KEY=

# ============================================================
# JWT & Security [CRITICAL FOR PRODUCTION]
# ============================================================
# IMPORTANT: Generate a secure random key for production!
# Run: openssl rand -base64 64
# The key must be at least 32 characters (256 bits)
JWT_SECRET_KEY=your-256-bit-secret-key-here
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=15
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# ============================================================
# CORS Configuration [REQUIRED FOR PRODUCTION]
# ============================================================
# For development: leave empty to allow localhost
# For production: comma-separated list of allowed origins
# Example: CORS_ORIGINS=https://your-domain.com,https://app.your-domain.com
CORS_ORIGINS=

# ============================================================
# Request Limits
# ============================================================
MAX_REQUEST_SIZE_MB=10

# ============================================================
# Database Connection Pool
# ============================================================
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=1800

# ============================================================
# Application Configuration
# ============================================================
ENVIRONMENT=development
LOG_LEVEL=DEBUG
DEBUG=true

# ============================================================
# Feature Flags
# ============================================================
SHADOW_TRAFFIC_ENABLED=true
SHADOW_PERCENTAGE=100
FEATURE_FLAGS_PROVIDER=flagsmith
FEATURE_FLAGS_API_URL=
FEATURE_FLAGS_API_KEY=

# ============================================================
# Compliance Mode
# ============================================================
# Options: standard, financial, hipaa, fedramp, gdpr
COMPLIANCE_MODE=standard

# ============================================================
# Offline Mode (Local Models)
# ============================================================
OFFLINE_MODE=false
LOCAL_MODEL_CODELLAMA=http://localhost:8100/v1
LOCAL_MODEL_DEEPSEEK=http://localhost:8101/v1
EMBEDDING_SERVER=http://localhost:8102

# ============================================================
# Monitoring
# ============================================================
PROMETHEUS_URL=http://localhost:9090
GRAFANA_URL=http://localhost:3001
GRAFANA_PASSWORD=admin

# ============================================================
# OPA Policy Engine
# ============================================================
OPA_URL=http://localhost:8181

# ============================================================
# Services URLs (Internal)
# ============================================================
VCAI_URL=http://localhost:8001
CRAI_URL=http://localhost:8002
LIFECYCLE_CONTROLLER_URL=http://localhost:8003
EVALUATION_PIPELINE_URL=http://localhost:8004

# ============================================================
# OAuth Configuration (GitHub, GitLab)
# ============================================================
# These are APPLICATION credentials - each user connects THEIR OWN account
#
# HOW IT WORKS:
# 1. You create an OAuth App (one for your entire platform)
# 2. Users click "Connect GitHub" and authorize YOUR app
# 3. Each user's GitHub account is connected individually
# 4. Your app can then access their repos on their behalf
#
# ============================================================
# GITHUB OAuth Setup:
# ============================================================
# 1. Go to: https://github.com/settings/developers
# 2. Click "New OAuth App"
# 3. Fill in:
#    - Application name: AI Code Review Platform (or your name)
#    - Homepage URL: http://localhost:5173
#    - Authorization callback URL: http://localhost:5173/oauth/callback/github
# 4. Click "Register application"
# 5. Copy the Client ID below
# 6. Generate a Client Secret and copy it below
#
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=
GITHUB_CALLBACK_URL=http://localhost:5173/oauth/callback/github

# ============================================================
# GITLAB OAuth Setup:
# ============================================================
# 1. Go to: https://gitlab.com/-/profile/applications
# 2. Create new application with:
#    - Name: AI Code Review Platform
#    - Redirect URI: http://localhost:5173/oauth/callback/gitlab
#    - Scopes: read_user, read_repository, api
# 3. Copy Application ID and Secret below
#
GITLAB_CLIENT_ID=
GITLAB_CLIENT_SECRET=
GITLAB_CALLBACK_URL=http://localhost:5173/oauth/callback/gitlab

# Bitbucket uses personal API tokens (OAuth deprecated Sep 2025)
# Users add their own tokens in the Settings page
BITBUCKET_API_TOKEN=

# ============================================================
# Frontend Configuration
# ============================================================
# Vite environment variables (must start with VITE_)
VITE_API_URL=http://localhost:8000
VITE_WS_URL=ws://localhost:8000/ws

# Legacy React environment variables (for compatibility)
REACT_APP_API_URL=http://localhost:8000
REACT_APP_WS_URL=ws://localhost:8000/ws

# ============================================================
# Docker Compose Specific
# ============================================================
VERSION=latest
REGISTRY=gcr.io/coderev-platform
MODEL_DIR=/data/models
