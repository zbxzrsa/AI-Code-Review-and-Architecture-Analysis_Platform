# SealedSecrets for Offline Deployment
# These are encrypted and safe to store in git
# Decrypt with kubeseal and your cluster's sealed-secrets controller
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: database-credentials
  namespace: platform-offline
spec:
  encryptedData:
    # Sealed with: kubeseal --cert sealed-secrets-cert.pem
    POSTGRES_HOST: AgBy... # Replace with actual sealed value
    POSTGRES_PORT: AgBy...
    POSTGRES_USER: AgBy...
    POSTGRES_PASSWORD: AgBy...
    POSTGRES_DB: AgBy...
  template:
    metadata:
      name: database-credentials
      namespace: platform-offline
    type: Opaque
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: redis-credentials
  namespace: platform-offline
spec:
  encryptedData:
    REDIS_HOST: AgBy...
    REDIS_PORT: AgBy...
    REDIS_PASSWORD: AgBy...
  template:
    metadata:
      name: redis-credentials
      namespace: platform-offline
    type: Opaque
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: encryption-keys
  namespace: platform-offline
spec:
  encryptedData:
    # AES-256-GCM encryption key for data at rest
    DATA_ENCRYPTION_KEY: AgBy...
    # HMAC key for audit log integrity
    AUDIT_HMAC_KEY: AgBy...
    # JWT signing key
    JWT_SECRET_KEY: AgBy...
  template:
    metadata:
      name: encryption-keys
      namespace: platform-offline
    type: Opaque
---
# Template for creating secrets (do not commit actual values)
# Use this as a reference for what needs to be sealed
#
# kubectl create secret generic database-credentials \
#   --from-literal=POSTGRES_HOST=postgres.platform-offline.svc \
#   --from-literal=POSTGRES_PORT=5432 \
#   --from-literal=POSTGRES_USER=platform \
#   --from-literal=POSTGRES_PASSWORD=<secure-password> \
#   --from-literal=POSTGRES_DB=platform \
#   --dry-run=client -o yaml | kubeseal --format yaml > sealed-database.yaml
#
# kubectl create secret generic redis-credentials \
#   --from-literal=REDIS_HOST=redis.platform-offline.svc \
#   --from-literal=REDIS_PORT=6379 \
#   --from-literal=REDIS_PASSWORD=<secure-password> \
#   --dry-run=client -o yaml | kubeseal --format yaml > sealed-redis.yaml
#
# kubectl create secret generic encryption-keys \
#   --from-literal=DATA_ENCRYPTION_KEY=$(openssl rand -hex 32) \
#   --from-literal=AUDIT_HMAC_KEY=$(openssl rand -hex 32) \
#   --from-literal=JWT_SECRET_KEY=$(openssl rand -hex 64) \
#   --dry-run=client -o yaml | kubeseal --format yaml > sealed-encryption.yaml
